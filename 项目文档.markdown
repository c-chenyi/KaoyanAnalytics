## 目录

- **[1 项目概述](#1-项目概述)**  
  - [1.1 项目简介](#11-项目简介)  
  - [1.2 主要功能](#12-主要功能)  

- **[2 系统架构](#2-系统架构)**  
  - [2.1 技术栈](#21-技术栈)  
  - [2.2 模块结构](#22-模块结构)  

- **[3 功能描述](#3-功能描述)**  
  - [3.1 数据处理与存储](#31-数据处理与存储)  
  - [3.2 数据可视化](#32-数据可视化)  
  - [3.3 分数线预测与评估](#33-分数线预测与评估)  

- **[4 运行要求](#4-运行要求)**  
  - [环境依赖](#环境依赖)  
  - [数据准备](#41-数据准备)  

- **[5 使用说明](#5-使用说明)**  
  - [5.1 运行步骤](#51-运行步骤)  
  - [5.2 示例输出](#52-示例输出)  

- **[6 性能与限制](#6-性能与限制)**  
  - [6.1 性能](#61-性能)  
  - [6.2 限制](#62-限制)  

- **[7 未来改进方向](#7-未来改进方向)**  

- **[8 附录](#8-附录)**  
  - [8.1 数据库表结构](#81-数据库表结构)  
  - [8.2 参考资料](#82-参考资料)  

---

## 1 项目概述
### 1.1 项目简介：
项目名称: 考研数据分析与预测系统  
版本: 1.0  
日期: 2025年3月29日  
作者: ChenJianQuan 
目的:  
本项目旨在对考研分数线和调剂信息数据进行清洗、存储、可视化分析，并利用机器学习模型预测未来分数线趋势。通过交互式图表和词云展示数据特征，帮助考研学生和研究人员了解考研趋势和调剂信息分布。

### 1.2 主要功能:

1. 数据处理与存储：从 CSV 和 Excel 文件读取考研分数线和调剂数据，存储到 MySQL 数据库。
    
2. 数据可视化：生成交互式柱状图、折线图、饼图、地图和词云。
    
3. 分数线预测：使用线性回归和 ARIMA 模型预测未来三年（2021-2023）的专业分数线趋势，并评估模型效果。

---

## 2 系统架构

### 2.1 技术栈

- 编程语言: Python 3.11
    
- 数据处理:
    
    - pandas: 数据清洗与处理
        
    - numpy: 数值计算
        
- 数据库:
    
    - MySQL (mysql-connector-python): 数据存储
        
- 可视化:
    
    - pyecharts: 交互式图表（柱状图、折线图、饼图、地图）
        
    - stylecloud & matplotlib: 词云生成与显示
        
- 机器学习:
    
    - scikit-learn: 线性回归模型及评估指标 (R², RMSE)
        
    - statsmodels: ARIMA 时间序列模型
        
- 其他:
    
    - jieba: 中文分词
        
    - tqdm: 进度条
        
    - os & webbrowser: 文件操作与浏览器打开
        

### 2.2 模块结构

1. 数据库操作:
    
    - init_db_connection(): 初始化数据库连接
        
    - create_tables(): 创建分数线和调剂信息表
        
    - batch_insert(): 批量插入数据
        
2. 数据处理:
    
    - process_cutoff_data(): 处理考研分数线数据
        
    - process_adjustment_data(): 处理调剂信息数据
        
3. 可视化:
    
    - generate_wordcloud(): 生成词云
        
    - visualize_data_interactive(): 交互式数据可视化
        
4. 预测与评估:
    
    - predict_score_trend(): 分数线趋势预测与模型评估
        
5. 主函数:
    
    - main(): 项目执行入口
        

---

## 3 功能描述

### 3.1 数据处理与存储

- 输入:
    
    - 考研分数线: 考研历年国家分数线(1-6).csv
        
    - 调剂信息: 大学信息2021new.xlsx, 考研调剂数据-3.08.xlsx
        
- 处理:
    
    - 清洗：去重、去空值、规范化字段（如移除专业名称中的“专业学位”标记）
        
    - 转换：调剂数据中学校层次（985、211、双非）和类型（理工、综合等）分类
        
- 存储:
    
    - MySQL 数据库：
        
        - 考研分数线数据: 年份、学校、专业、分数等字段
            
        - 调剂信息: 学校、时间、省份、层次等字段
            

### 3.2 数据可视化

- 词云:
    
    - 输入：专业名称、学校名称
        
    - 输出：专业词云.png, 学校词云.png
        
- 交互式图表:
    
    - 柱状图: 2020 年各专业最高分、最低分、平均分，支持缩放、工具提示
        
    - 折线图: 调剂信息发布趋势，平滑曲线，标注最大/最小值
        
    - 饼图: 学校层次分布（玫瑰图样式）
        
    - 地图: 各省调剂信息数量分布
        
    - 输出：interactive_analysis_report.html
        

### 3.3 分数线预测与评估

- 预测:
    
    - 线性回归: 基于历史年份预测 2021-2023 年分数
        
    - ARIMA: 时间序列模型（p=1, d=1, q=0），预测 2021-2023 年分数
        
    - 输出：score_trend_prediction.html（实际数据实线，线性回归虚线，ARIMA 点线）
        
- 评估:
    
    - 线性回归：R²（拟合优度）、RMSE（均方根误差）
        
    - ARIMA：RMSE（拟合值与实际值误差）
        
    - 输出：控制台打印每个专业的评估指标
        

---

## 4 运行要求

### 环境依赖

- Python 版本: 3.11
    
- 依赖安装:
    
    ```bash
    pip install pandas numpy mysql-connector-python pyecharts jieba matplotlib stylecloud tqdm scikit-learn statsmodels
    ```
    
- 数据库: MySQL 8.0 或以上，需创建 kaoyan 数据库并配置 DB_CONFIG 中的 password。
    

### 4.1 数据准备

- 文件路径:
    
    - 分数线数据：./考研历年国家分数线(1-6).csv
        
    - 调剂数据：./大学信息2021new.xlsx, ./考研调剂数据-3.08.xlsx
        
- 要求: 分数线数据需至少包含 3 年以上数据以支持预测。
    

---

## 5 使用说明

### 5.1 运行步骤

1. 配置环境:
    
    - 安装依赖包。
        
    - 修改 DB_CONFIG 中的 password 为你的 MySQL 密码。
        
2. 准备数据:
    
    - 将 CSV 和 Excel 文件放置在项目根目录。
        
3. 执行程序:
    
    ```bash
    python main.py
    ```
    
4. 查看结果:
    
    - 词云：专业词云.png, 学校词云.png
        
    - 交互式图表：浏览器自动打开 interactive_analysis_report.html
        
    - 预测图表：浏览器自动打开 score_trend_prediction.html
        
    - 评估指标：控制台输出
        

### 5.2 示例输出

- 词云:  
    专业词云
    
- 交互式报告:
    
    - 柱状图：各专业分数统计
        
    - 折线图：调剂信息发布趋势
        
    - 饼图：学校层次分布
        
    - 地图：省份分布
        
- 预测图表:
    
    - 实际数据（实线）
        
    - 线性回归预测（虚线）
        
    - ARIMA 预测（点线）
        
- 控制台:
    
    ```text
    专业: 计算机科学与技术
    线性回归 R²: 0.8234
    线性回归 RMSE: 5.67
    ARIMA RMSE: 6.12
    ```
    

---

## 6 性能与限制

### 6.1 性能

- 数据处理: 批量插入优化了数据库写入性能，适合大规模数据。
    
- 可视化: pyecharts 生成的交互式图表支持大数据量展示。
    
- 预测: 线性回归和 ARIMA 适用于小规模时间序列数据，计算效率高。
    

### 6.2 限制

- 数据依赖: 预测准确性依赖历史数据的完整性和连续性（至少 3 年）。
    
- 模型简单性: 当前 ARIMA 参数固定为 (1,1,0)，未优化。
    
- 文件路径: 数据文件需严格按照指定路径放置。
    

---

## 7 未来改进方向

1. 动态年份预测: 添加用户输入界面，允许自定义预测年份范围。
    
2. 模型优化:
    
    - 网格搜索优化 ARIMA 参数 (p,d,q)。
        
    - 引入更多特征（如招生人数、经济指标）改进线性回归。
        
3. 交叉验证: 对线性回归添加 K 折交叉验证，提升模型稳定性。
    
4. 可视化增强: 添加筛选功能（如按专业、学校过滤数据）。
    
5. 部署: 将系统封装为 Web 应用，提供在线访问。
    

---

## 8 附录

### 8.1 数据库表结构

- 考研分数线数据:
    
    ```text
    年份 INT
    学校名称 VARCHAR(255)
    院系名称 VARCHAR(255)
    专业代码 VARCHAR(20)
    专业名称 VARCHAR(255)
    总分 VARCHAR(10)
    政治__管综 VARCHAR(10)
    外语 VARCHAR(10)
    业务课_一 VARCHAR(10)
    业务课_二 VARCHAR(10)
    ```
    
- 调剂信息:
    
    ```text
    school VARCHAR(255)
    name VARCHAR(255)
    time VARCHAR(50)
    province VARCHAR(50)
    school_level VARCHAR(20)
    school_types VARCHAR(20)
    ```
    

### 8.2 参考资料

- pandas 文档: [https://pandas.pydata.org/docs/](https://pandas.pydata.org/docs/)
    
- pyecharts 文档: [https://pyecharts.org/](https://pyecharts.org/)
    
- scikit-learn 文档: [https://scikit-learn.org/stable/](https://scikit-learn.org/stable/)
    
- statsmodels 文档: [https://www.statsmodels.org/stable/](https://www.statsmodels.org/stable/)
    
---